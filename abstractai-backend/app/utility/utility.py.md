# Internal Code Documentation: API Key Generation and Cost Calculation

[Linked Table of Contents](#linked-table-of-contents)

## Linked Table of Contents

* [1. Overview](#1-overview)
* [2. `generate_unique_api_key()` Function](#2-generate_unique_api_key-function)
* [3. `cost_per_query()` Function](#3-cost_per_query-function)


## 1. Overview

This document details the functionality of two Python functions: `generate_unique_api_key()` and `cost_per_query()`.  These functions are designed to generate unique API keys and calculate the cost of queries based on token counts and predefined pricing.


## 2. `generate_unique_api_key()` Function

This function generates a unique API key using the `secrets` module.

```python
import secrets

def generate_unique_api_key():
    return secrets.token_hex(32)
```

**Function Description:**

The `generate_unique_api_key()` function leverages the Python `secrets` module to create cryptographically secure random hexadecimal strings.  These strings are 64 characters long (32 hex characters * 2 hex digits per character) and are highly unlikely to collide, making them suitable for use as API keys.


**Algorithm:**

1. The function imports the `secrets` module, which provides functions for generating cryptographically strong random numbers.
2. It calls `secrets.token_hex(32)`.  This function generates a random hexadecimal string of length 32 * 2 = 64 characters.
3. The generated string (the API key) is returned.


## 3. `cost_per_query()` Function

This function calculates the cost of a query based on the number of input and output tokens and their respective costs per million tokens.

```python
def cost_per_query(input_cost_per_million, output_cost_per_million, num_input_tokens, num_output_tokens):
    cost_for_input = (input_cost_per_million / 1_000_000) * num_input_tokens
    cost_for_output = (output_cost_per_million / 1_000_000) * num_output_tokens
    total_cost = cost_for_input + cost_for_output
    return total_cost
```

**Function Description:**

The `cost_per_query()` function computes the total cost of a query given the cost per million tokens for input and output, along with the number of input and output tokens used in the query.

**Parameters:**

| Parameter Name             | Data Type        | Description                                         |
|-----------------------------|--------------------|-----------------------------------------------------|
| `input_cost_per_million` | `float` or `int` | Cost of 1,000,000 input tokens.                    |
| `output_cost_per_million`| `float` or `int` | Cost of 1,000,000 output tokens.                   |
| `num_input_tokens`        | `int`             | Number of input tokens used in the query.           |
| `num_output_tokens`       | `int`             | Number of output tokens generated by the query.      |

**Algorithm:**

1. **Calculate Input Cost:** The cost of input tokens is determined by dividing the `input_cost_per_million` by 1,000,000 to get the cost per token, then multiplying by the `num_input_tokens`.
2. **Calculate Output Cost:** Similarly, the cost of output tokens is calculated by dividing the `output_cost_per_million` by 1,000,000 and multiplying by the `num_output_tokens`.
3. **Calculate Total Cost:** The total cost is the sum of the input cost and the output cost.
4. **Return Total Cost:** The function returns the calculated `total_cost`.

**Example:**

If `input_cost_per_million` = 10, `output_cost_per_million` = 5, `num_input_tokens` = 1000, and `num_output_tokens` = 500, then:

* `cost_for_input` = (10 / 1,000,000) * 1000 = 0.01
* `cost_for_output` = (5 / 1,000,000) * 500 = 0.0025
* `total_cost` = 0.01 + 0.0025 = 0.0125


The function will return 0.0125.
